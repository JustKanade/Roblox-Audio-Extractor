name: Auto Build and Release

on:

# push:

# branches: \[ "main" ]

workflow\_dispatch:

permissions:
contents: write

jobs:
prepare:
runs-on: ubuntu-latest
outputs:
tag: \${{ steps.set-tag.outputs.tag }}
build\_date: \${{ steps.set-date.outputs.date }}
steps:
\# (prepare tag and date steps...)

build-windows:
needs: prepare
runs-on: windows-latest
steps:
\- uses: actions/checkout\@v4
\- uses: actions/setup-python\@v5
with:
python-version: "3.10"
\- run: |
python -m pip install --upgrade pip
if (Test-Path "requirements.txt") { pip install -r requirements.txt }
pip install pyinstaller
\- run: |
pyinstaller --onefile --windowed `            --icon=icons/Roblox-Audio-Extractor.ico`
\--add-data="icons/*;icons" `            --name Roblox_Audio_Extractor_${{ needs.prepare.outputs.tag }}_win`
Roblox\_Audio\_Extractor.py
\- name: Install UPX
run: choco install upx -y --no-progress
\- name: Compress Windows executable
run: |
\# 使用更激进的 ultra-brute 模式进行压缩
upx --ultra-brute dist\*.exe
\- uses: actions/upload-artifact\@v4
with:
name: Windows-Build
path: dist/*

build-linux:
needs: prepare
runs-on: ubuntu-latest
steps:
\- uses: actions/checkout\@v4
\- uses: actions/setup-python\@v5
with:
python-version: "3.10"
\- run: |
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install pyinstaller
\- run: |
pyinstaller --onefile&#x20;
\--add-data="icons/*:icons"&#x20;
\--name Roblox\_Audio\_Extractor\_\${{ needs.prepare.outputs.tag }}\_linux&#x20;
Roblox\_Audio\_Extractor.py
\- name: Install UPX
run: sudo apt-get update && sudo apt-get install -y upx
\- name: Compress Linux executable
run: |
\# 使用更激进的 ultra-brute 模式进行压缩
upx --ultra-brute dist/*
\- uses: actions/upload-artifact\@v4
with:
name: Linux-Build
path: dist/\*

build-macos:
needs: prepare
runs-on: macos-latest
steps:
\- uses: actions/checkout\@v4
\- uses: actions/setup-python\@v5
with:
python-version: "3.10"
\- run: |
python -m pip install --upgrade pip
pip install -r requirements.txt
pip install pyinstaller
\- run: |
pyinstaller --onefile&#x20;
\--add-data="icons/*:icons"&#x20;
\--name Roblox\_Audio\_Extractor\_\${{ needs.prepare.outputs.tag }}\_macos&#x20;
Roblox\_Audio\_Extractor.py
\- name: Install UPX via Homebrew
run: brew install upx
\- name: Compress macOS executable
run: |
upx --best --lzma dist/*
\- uses: actions/upload-artifact\@v4
with:
name: macOS-Build
path: dist/\*

release:
needs:
\- build-windows
\- build-linux
\- build-macos
runs-on: ubuntu-latest
steps:
\- uses: softprops/action-gh-release\@v1
with:
tag\_name: \${{ needs.prepare.outputs.tag }}
name: "Development Build (\${{ needs.prepare.outputs.build\_date }})"
body: |
Development preview build – Bugs may appear, if you notice issues please report.

```
        **Commit:** ${{ github.sha }}
        **Build date:** ${{ needs.prepare.outputs.build_date }}
      files: |
        artifacts/Windows-Build/*
        artifacts/Linux-Build/*
        artifacts/macOS-Build/*
      prerelease: true
      draft: false
```
